<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<title>Tests</title>
<style>
	canvas {
		--size: 90vh;
		width: var(--size);
		height: var(--size);
		position: absolute;
		left: 50%;
		top: 50%;
		transform: translate(-50%, -50%);
		border: 1px solid;
	}
</style>

<body>
	<canvas width=1000 height=1000>
	</canvas>
	<script>
		function log(...args) {
			console.log(...args)
		}

		let canvas = document.querySelector('canvas')
		let ctx = canvas.getContext('2d')

		let boxes = [
			{ x: 100, y: 100, width: 100, height: 100, velocity: { x: 500, y: 500 } }
		]

		function clear() {
			ctx.fillStyle = 'white'
			ctx.clearRect(0, 0, 1000, 1000)
		}

		function drawGrid() {
			for (let i = 0; i < 10; i++) {

				const LINE_WIDTH = 1

				ctx.fillStyle = '#bbb'
				ctx.fillRect(i * 100 - 0.5 * LINE_WIDTH, 0, LINE_WIDTH, 1000)
				ctx.fillRect(0, i * 100 - 0.5 * LINE_WIDTH, 1000, LINE_WIDTH)
			}
		}

		const FRAME_DURATION = 1 / 60

		function updateBoxes() {
			for (let box of boxes) {
				box.x += box.velocity.x * FRAME_DURATION
				box.y += box.velocity.y * FRAME_DURATION

				if (box.x < 0 || box.x + box.width > 1000) {
					box.velocity.x *= -1
				}

				if (box.y < 0 || box.y + box.height > 1000) {
					box.velocity.y *= -1
				}
			}
		}

		function drawBoxes() {
			for (let box of boxes) {
				ctx.fillStyle = 'black'
				ctx.fillRect(box.x, box.y, box.width, box.height)
			}
		}

		function frame() {
			clear()
			drawGrid()
			updateBoxes()
			drawBoxes()
			requestAnimationFrame(frame)
		}

		requestAnimationFrame(frame)
		// setInterval(frame, FRAME_DURATION * 1000)
	</script>
</body>
